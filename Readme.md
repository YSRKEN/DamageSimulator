# KancolleDamageSimulator

## 概要
　[艦これ](http://www.dmm.com/netgame/feature/kancolle.html)用のダメージ計算機です。[ばいなり](https://twitter.com/b_inary)さんの[ダメージ計算機](http://kancollecalc.web.fc2.com/damage.html)からヒントを得て作られました。  
　戦闘時の状況を入力すると、与えられるダメージ量が[モンテカルロシミュレーション](https://ja.wikipedia.org/wiki/%E3%83%A2%E3%83%B3%E3%83%86%E3%82%AB%E3%83%AB%E3%83%AD%E6%B3%95)で計算され、グラフとして表示されます。  
　また、耐久値を入力することにより、大破率や撃沈率なども表示することができます。  
　更に、計算結果やヒストグラムの数値やグラフの画像をクリップボードにコピーしたり、保存したりすることができます。  
　なお、このソフトウェアは[WPF](https://ja.wikipedia.org/wiki/Windows_Presentation_Foundation)を用いて作られました。  
　ソフトウェアの動作には、.NET Framework 4.5.2以降が必要です。

## 使い方

![説明用画像](https://cloud.githubusercontent.com/assets/3734392/18584576/93614ff6-7c4c-11e6-9073-d952fdae0e99.png)

- 本家の[ダメージ計算機](http://kancollecalc.web.fc2.com/damage.html)と操作性はほぼ一緒です
- 『攻撃側設定』グループで交戦形態などの設定を行います。右上のタブで攻撃種別が分かれています
- 『防御用設定』グループで敵装甲値などの設定を行います。艦娘相手に攻撃する際は『艦娘フラグ』にチェック！
 - 『ギミックフラグ』をチェックすると、ギミックをこなした後のようにダメージが通るようになります
- 『計算条件』グループで試行回数などの設定を行います。計算は軽いので、試行回数は常時100万回でいいかと
- 『計算開始』ボタンを押せば計算しますし、『自動で再計算』にチェックを入れればより便利に扱えます
- 計算し終えると、ダメージ幅や、大破率・撃沈率などが[ツールチップ](https://ja.wikipedia.org/wiki/%E3%83%84%E3%83%BC%E3%83%AB%E3%83%81%E3%83%83%E3%83%97)で表示されます
- 『計算開始』ボタンの上で右クリックすると、計算結果、およびヒストグラムのデータをテキストか画像でコピー or 保存できます
- ヒストグラムのテキストデータはCSV形式で、左列からダメージ値・カウント数・カウント割合・標本標準偏差・95％信頼区間(最小値―最大値)を表します
- 『twice flg』にチェックを入れると、連撃・魚魚カットイン・主魚カットインの際に2回攻撃した際の結果が表示されます
- 『徹甲弾特効』コンボボックスは、砲撃戦でのキャップ後補正の他、対砲台子鬼でのキャップ前補正の意味もありますのでご注意ください
- 画面中央のコンボボックス×3は、左から順に艦種・艦型・艦名を表しています。それらを選択してから『攻』か『防』を押すと、その艦のパラメータがそれぞれに反映されます
 - コンボボックスの右にある『ケッコンカッコカリ』チェックボックスを入れた状態でプリセットすると、ケッコン状態でのパラメータになります
- Ver.1.0.5から、攻撃用設定および防御用設定グループ内に、『どの艦が攻撃/防御したか』をメモするためのテキストボックスを設置しました
 - テキストボックスの中身はプリセット機能使用で書き換わりますが、手動でも編集可能です
- Ver.1.0.5から、弾薬量補正を更に細かく編集できるスピンボタンを設置しました
 - 攻撃用設定における、メモ用テキストボックスの右に配置してます(数値は割合％)
 - 弾薬量残量のコンボボックスの一番下にある『手動設定』を選択した場合にのみ有効です

## 注意点
- **このソフトによる計算結果には一切責任を持ちません**
- 航空戦で交戦形態・攻撃陣形・損傷状態が、夜戦で交戦形態・攻撃陣形が無視されるのは**仕様です**
- 本家の[ダメージ計算機](http://kancollecalc.web.fc2.com/damage.html)と同じく、以下の項目には対応していません
 - 支援艦隊
 - [PT小鬼群特効](http://ja.kancolle.wikia.com/wiki/%E7%89%B9%E5%8A%B9%E8%A3%85%E5%82%99#PT.E5.B0.8F.E9.AC.BC.E7.BE.A4.E7.89.B9.E5.8A.B9)
- また、本家の[ダメージ計算機](http://kancollecalc.web.fc2.com/damage.html)とは以下の点が異なります
 - [艦載機熟練度補正](http://ja.kancolle.wikia.com/wiki/%E8%89%A6%E8%BC%89%E6%A9%9F%E7%86%9F%E7%B7%B4%E5%BA%A6)において、最大値(<<)ではない場合も**攻撃力増加量が表記熟練度に比例する**と仮定している
 - [致死ダメージ置換](http://ja.kancolle.wikia.com/wiki/%E3%83%80%E3%83%A1%E3%83%BC%E3%82%B8%E7%BD%AE%E6%8F%9B)(いわゆる大破/撃沈ストッパー)に対応しているので、**艦娘に向けた攻撃でも対応可能**
- プリセット機能で使えるデータの中身は、preset.csvに示す通りです
 - index,type,class,name,attack,torpedo1,bomb,torpedo2,pa_pb_power,slot_size,anti_sub_body,anti_sub_weapon,defense,hp,marriage_hp,marriage_anti_sub_bodyは、
 - それぞれ振り番号・艦種・艦型・艦名・火力・雷装・爆装・空母の雷装・航空戦火力・搭載数・素対潜・装備対潜・装甲・最大耐久・ケッコン時最大耐久・ケッコン時素対潜(Lv155時)を表します
 - 振り番号はダミーですのでどう振っても構いません
 - 雷装＝素雷装＋装備雷装。ただし空母だけは意図的に0としています
 - 空母の雷装＝装備している艦攻全部の雷撃値合計(空母砲撃戦用のパラメータ)
 - 航空戦火力＝「最大の火力が出せるスロット」に載っている艦載機の雷装 or 爆装。雷装だと値をマイナスにしている
 - 搭載数＝「最大の火力が出せるスロット」の搭載数
 - 艦娘は未装備のパラメータですが、深海棲艦は装備済のパラメータですのでご注意ください
- 集積地棲姫に対するキャップ後特効について、陸戦隊は関与しますが大発は関与しませんのでご注意下さい
- コンボボックスの選択による、他のオブジェクトへの制御は以下の通りです
 - 攻撃種別の設定による、画面左上の艦隊～損傷形態コンボボックスのON/OFF
 - 砲撃戦および夜戦にて、攻撃対象の種別(通常艦～離島棲姫)による、同タブ内のオブジェクトON/OFF
 - 砲撃戦および夜戦にて、大発およびカミ車の数による装備改修種別コンボボックスの制御
- 装備改修は、本来次の装備が効力を発揮しますのでご注意下さい
 - 砲撃戦→魚雷、水上偵察機、電探を除く全ての装備
 - 雷撃戦→魚雷、機銃
 - 対潜攻撃→爆雷、ソナー
 - 夜戦→水上偵察機、電探、機銃、爆雷、ソナーを除く全ての装備
- **実装の都合上、大発の改修星に関係するのは「左側2つ」、カミ車の改修星に関係するのは「右側2つ」と決め打ちしています**

## ライセンス
[MIT License](https://ja.wikipedia.org/wiki/MIT_License)

## 更新履歴
|Version|Information|
|-------|-----------|
|1.0.7|昼戦キャップを更新・敵データを一部修正・徹甲弾特効で+副砲と+電探の倍率が逆だったので修正|
|1.0.6|ギミック補正および軽巡軽量砲補正を追加・新艦追加|
|1.0.5|メモ用テキストボックス設置・弾薬量補正機能追加・ケッコンカッコカリ対応・割合ダメージ率を計算|
|1.0.4|艦娘フラグや攻撃種別の項目もプリセット機能で切り替わるように・プリセットデータのミス修正・平均ダメージ表示・各種特効を追加・特効に改修を反映|
|1.0.3|プリセット機能を実装・右クリックで結果コピー可能に|
|1.0.2|各種対地特効を実装完了・連合艦隊に対応・その他バグ修正|
|1.0.1|連撃・魚魚カットイン・主魚カットイン時に2回攻撃することを反映|
|1.0.0|最初のリリース|
